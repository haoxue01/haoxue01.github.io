<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Publications | Hao Xue</title>
    <meta name="description" content="Publications of Hao Xue">
    <!-- Open Graph -->
    <!-- Bootstrap & MDB -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg=="
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css"
        integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q=="
        crossorigin="anonymous" />
    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"
        integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog=="
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css"
        integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg=="
        crossorigin="anonymous">
    <link rel="stylesheet" type="text/css"
        href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">
    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://combinatronics.io/jwarby/pygments-css/master/github.css" />
    <!-- Styles -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>📖</text></svg>">
    <link rel="stylesheet" href="/assets/main.css">
    <link rel="canonical" href="/publications.html">

    <!-- JQuery -->
    <!-- jQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"
        integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg=="
        crossorigin="anonymous"></script>
    <!-- Theming-->
    <script src="/assets/theme.js"></script>
    <script src="/assets/dark_mode.js"></script>
    <!-- MathJax -->
    <script type="text/javascript">
        window.MathJax = {
            tex: {
                tags: 'ams'
            }
        };
    </script>
    <script defer type="text/javascript" id="MathJax-script"
        src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
    <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    <!-- BibTeX Parser -->
    <script>
        /* start bibtexParse 0.0.24 */

        // Original work by Henrik Muehe (c) 2010
        //
        // CommonJS port by Mikola Lysenko 2013
        //
        // Port to Browser lib by ORCID / RCPETERS
        //
        // Issues:
        //  no comment handling within strings
        //  no string concatenation
        //  no variable values yet
        //  Grammar implemented here:
        //      bibtex -> (string | preamble | comment | entry)*;
        //      string -> '@STRING' '{' key_equals_value '}';
        //      preamble -> '@PREAMBLE' '{' value '}';
        //      comment -> '@COMMENT' '{' value '}';
        //      entry -> '@' key '{' key ',' key_value_list '}';
        //      key_value_list -> key_equals_value (',' key_equals_value)*;
        //      key_equals_value -> key '=' value;
        //      value -> value_quotes | value_braces | key;
        //      value_quotes -> '"' .*? '"'; // not quite
        //      value_braces -> '{' .*? '"'; // not quite
        
        (function(exports) {

            function BibtexParser() {
                this.pos = 0;
                this.input = "";
                this.entries = new Array();
                this.strings = {
                    JAN: "January",
                    FEB: "February",
                    MAR: "March",
                    APR: "April",
                    MAY: "May",
                    JUN: "June",
                    JUL: "July",
                    AUG: "August",
                    SEP: "September",
                    OCT: "October",
                    NOV: "November",
                    DEC: "December"
                };
                this.currentEntry = "";
            }

            BibtexParser.prototype.setInput = function(t) {
                this.input = t;
            };

            BibtexParser.prototype.getEntries = function() {
                return this.entries;
            };

            BibtexParser.prototype.isWhitespace = function(s) {
                return (s == ' ' || s == '\r' || s == '\t' || s == '\n');
            };

            BibtexParser.prototype.match = function(s, canCommentOut) {
                if (canCommentOut == undefined || canCommentOut == null)
                    canCommentOut = true;
                this.skipWhitespace(canCommentOut);
                if (this.input.substring(this.pos, this.pos + s.length) == s) {
                    this.pos += s.length;
                } else {
                    throw "Token mismatch, expected " + s + ", found " +
                        this.input.substring(this.pos);
                }
                this.skipWhitespace(canCommentOut);
            };

            BibtexParser.prototype.tryMatch = function(s, canCommentOut) {
                if (canCommentOut == undefined || canCommentOut == null)
                    canCommentOut = true;
                this.skipWhitespace(canCommentOut);
                if (this.input.substring(this.pos, this.pos + s.length) == s) {
                    return true;
                } else {
                    return false;
                }
            };

            /* when search for a match all text can be ignored, not just white space */
            BibtexParser.prototype.matchAt = function() {
                while (this.input.length > this.pos && this.input[this.pos] != '@') {
                    this.pos++;
                }
                if (this.input[this.pos] == '@') {
                    return true;
                }
                return false;
            };

            BibtexParser.prototype.skipWhitespace = function(canCommentOut) {
                while (this.isWhitespace(this.input[this.pos])) {
                    this.pos++;
                }
                if (this.input[this.pos] == "%" && canCommentOut == true) {
                    while (this.input[this.pos] != "\n") {
                        this.pos++;
                    }
                    this.skipWhitespace(canCommentOut);
                }
            };

            BibtexParser.prototype.value_braces = function() {
                var bracecount = 0;
                this.match("{", false);
                var start = this.pos;
                var escaped = false;
                while (true) {
                    if (!escaped) {
                        if (this.input[this.pos] == '}') {
                            if (bracecount > 0) {
                                bracecount--;
                            } else {
                                var end = this.pos;
                                this.match("}", false);
                                return this.input.substring(start, end);
                            }
                        } else if (this.input[this.pos] == '{') {
                            bracecount++;
                        } else if (this.pos >= this.input.length - 1) {
                            throw "Unterminated value";
                        }
                    }
                    if (this.input[this.pos] == '\\' && !escaped)
                        escaped = true;
                    else
                        escaped = false;
                    this.pos++;
                }
            };

            BibtexParser.prototype.value_quotes = function() {
                this.match('"', false);
                var start = this.pos;
                var escaped = false;
                while (true) {
                    if (!escaped) {
                        if (this.input[this.pos] == '"') {
                            var end = this.pos;
                            this.match('"', false);
                            return this.input.substring(start, end);
                        } else if (this.pos >= this.input.length - 1) {
                            throw "Unterminated value:" + this.input.substring(start);
                        }
                    }
                    if (this.input[this.pos] == '\\' && !escaped)
                        escaped = true;
                    else
                        escaped = false;
                    this.pos++;
                }
            };

            BibtexParser.prototype.single_value = function() {
                var start = this.pos;
                if (this.tryMatch("{")) {
                    return this.value_braces();
                } else if (this.tryMatch('"')) {
                    return this.value_quotes();
                } else {
                    var k = this.key();
                    if (this.strings[k.toUpperCase()]) {
                        return this.strings[k];
                    } else if (k.match("^[0-9]+$")) {
                        return k;
                    } else {
                        throw "Value expected:" + this.input.substring(start);
                    }
                }
            };

            BibtexParser.prototype.value = function() {
                var values = [];
                values.push(this.single_value());
                while (this.tryMatch("#")) {
                    this.match("#");
                    values.push(this.single_value());
                }
                return values.join("");
            };

            BibtexParser.prototype.key = function() {
                var start = this.pos;
                while (true) {
                    if (this.pos >= this.input.length) {
                        throw "Runaway key";
                    }
                    if (this.input[this.pos].match("[a-zA-Z0-9+_:\\./-]")) {
                        this.pos++;
                    } else {
                        return this.input.substring(start, this.pos);
                    }
                }
            };

            BibtexParser.prototype.key_equals_value = function() {
                var key = this.key();
                if (this.tryMatch("=")) {
                    this.match("=");
                    var val = this.value();
                    return [key, val];
                } else {
                    throw "... = value expected, equals sign missing:" + this.input.substring(this.pos);
                }
            };

            BibtexParser.prototype.key_value_list = function() {
                var kv = this.key_equals_value();
                this.currentEntry['entryTags'] = {};
                this.currentEntry['entryTags'][kv[0]] = kv[1];
                while (this.tryMatch(",")) {
                    this.match(",");
                    // fixes problems with commas at the end of a list
                    if (this.tryMatch("}")) {
                        break;
                    }
                    kv = this.key_equals_value();
                    this.currentEntry['entryTags'][kv[0]] = kv[1];
                }
            };

            BibtexParser.prototype.entry_body = function(d) {
                this.currentEntry = {};
                this.currentEntry['citationKey'] = this.key();
                this.currentEntry['entryType'] = d.substring(1);
                this.match(",");
                this.key_value_list();
                this.entries.push(this.currentEntry);
            };

            BibtexParser.prototype.directive = function() {
                this.match("@");
                return "@" + this.key();
            };

            BibtexParser.prototype.preamble = function() {
                this.currentEntry = {};
                this.currentEntry['entryType'] = 'PREAMBLE';
                this.currentEntry['entry'] = this.value_comment();
                this.entries.push(this.currentEntry);
            };

            BibtexParser.prototype.comment = function() {
                this.currentEntry = {};
                this.currentEntry['entryType'] = 'COMMENT';
                this.currentEntry['entry'] = this.value_comment();
                this.entries.push(this.currentEntry);
            };

            BibtexParser.prototype.entry = function(d) {
                this.entry_body(d);
            };

            BibtexParser.prototype.bibtex = function() {
                while (this.matchAt()) {
                    var d = this.directive();
                    this.match("{");
                    if (d == "@STRING") {
                        this.string();
                    } else if (d == "@PREAMBLE") {
                        this.preamble();
                    } else if (d == "@COMMENT") {
                        this.comment();
                    } else {
                        this.entry(d);
                    }
                    this.match("}");
                }
            };

            BibtexParser.prototype.string = function() {
                var kv = this.key_equals_value();
                this.strings[kv[0].toUpperCase()] = kv[1];
            };

            BibtexParser.prototype.value_comment = function() {
                var str = '';
                var brcktCnt = 0;
                while (!(this.tryMatch("}", false) && brcktCnt == 0)) {
                    str = str + this.input[this.pos];
                    if (this.input[this.pos] == '{')
                        brcktCnt++;
                    if (this.input[this.pos] == '}')
                        brcktCnt--;
                    if (this.pos >= this.input.length - 1) {
                        throw "Runaway comment";
                    }
                    this.pos++;
                }
                return str;
            };

            //Runs the parser
            BibtexParser.prototype.parse = function() {
                this.pos = 0;
                this.entries = new Array();
                this.strings = {
                    JAN: "January",
                    FEB: "February",
                    MAR: "March",
                    APR: "April",
                    MAY: "May",
                    JUN: "June",
                    JUL: "July",
                    AUG: "August",
                    SEP: "September",
                    OCT: "October",
                    NOV: "November",
                    DEC: "December"
                };
                this.currentEntry = "";

                this.bibtex();
                return this.entries;
            };

            // module.exports = BibtexParser;
            window.bibtexParse = {
                toJSON: function(input) {
                    var b = new BibtexParser();
                    b.setInput(input);
                    return b.parse();
                }
            };
        })(typeof exports === 'undefined' ? this : exports);

        /* end bibtexParse */
    </script>

    <!-- Custom CSS for publications -->
    <style>
        .publication-section {
            margin-bottom: 2rem;
        }
        .publication-year {
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            font-size: 1.2rem;
            cursor: pointer;
            user-select: none;
        }
        .publication-year:hover {
            color: var(--global-theme-color);
        }
        .publication-year::before {
            content: '▼';
            display: inline-block;
            margin-right: 5px;
            transition: transform 0.2s;
            font-size: 0.8em;
        }
        .publication-year.collapsed::before {
            transform: rotate(-90deg);
        }
        .publication-section h2 {
            cursor: pointer;
            user-select: none;
            display: flex;
            align-items: center;
        }
        .publication-section h2:hover {
            color: var(--global-theme-color);
        }
        .publication-section h2::before {
            content: '▼';
            display: inline-block;
            margin-right: 10px;
            transition: transform 0.2s;
            font-size: 0.8em;
        }
        .publication-section h2.collapsed::before {
            transform: rotate(-90deg);
        }
        .publication-item {
            margin-bottom: 1.5rem;
            padding-left: 1rem;
            border-left: 3px solid var(--global-divider-color);
            transition: opacity 0.3s, max-height 0.3s;
        }
        .publication-title {
            font-weight: 500;
            color: var(--global-text-color);
        }
        .publication-authors {
            font-style: italic;
            color: var(--global-text-color-light);
        }
        .publication-venue {
            color: var(--global-text-color-light);
        }
        .publication-links a {
            margin-right: 1rem;
            color: var(--global-theme-color);
        }
        .publication-links a:hover {
            color: var(--global-hover-color);
            text-decoration: none;
        }
        .publications-list {
            transition: max-height 0.3s ease-out;
            overflow: hidden;
        }
        .publications-list.collapsed {
            max-height: 0 !important;
        }
        .year-group {
            transition: max-height 0.3s ease-out;
            overflow: hidden;
        }
        .year-group.collapsed {
            max-height: 0 !important;
        }
        
        /* Dark theme specific styles */
        [data-theme="dark"] .publication-item {
            border-left-color: var(--global-divider-color);
        }
        [data-theme="dark"] .publication-title {
            color: var(--global-text-color);
        }
        [data-theme="dark"] .publication-authors,
        [data-theme="dark"] .publication-venue {
            color: var(--global-text-color-light);
        }
        [data-theme="dark"] .publication-links a {
            color: var(--global-theme-color);
        }
        [data-theme="dark"] .publication-links a:hover {
            color: var(--global-hover-color);
        }
        [data-theme="dark"] .publication-year {
            color: var(--global-text-color-light);
        }
        .bibtex-input {
            width: 100%;
            margin-bottom: 1rem;
        }
    </style>
</head>
<body class="fixed-top-nav sticky-bottom-footer">
    <!-- Header -->
    <header>
        <!-- Nav Bar -->
        <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
            <div class="container">
                <a class="navbar-brand title font-weight-lighter" href="haoxue01.github.io/"></a>
                <!-- Navbar Toggle -->
                <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse"
                    data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"
                    aria-label="Toggle navigation">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar top-bar"></span>
                    <span class="icon-bar middle-bar"></span>
                    <span class="icon-bar bottom-bar"></span>
                </button>
                <div class="collapse navbar-collapse text-right" id="navbarNav">
                    <ul class="navbar-nav ml-auto flex-nowrap">
                        <!-- About -->
                        <li class="nav-item ">
                            <a class="nav-link" href="/index.html">
                                About
                            </a>
                        </li>
                        <!-- Other pages -->
                        <li class="nav-item ">
                            <a class="nav-link" href="/publications.html">
                                Publications
                                <span class="sr-only">(current)</span>
                            </a>
                        </li>
                        <li class="nav-item ">
                            <a class="nav-link" href="/teaching.html">
                                Teaching
                            </a>
                        </li>
                        <li class="nav-item ">
                            <a class="nav-link" href="/services.html">
                                Service
                            </a>
                        </li>
                        <li class="nav-item ">
                            <a class="nav-link" href="/supervision.html">
                                Supervision
                            </a>
                        </li>
                        <li class="nav-item ">
                            <a class="nav-link" href="https://cruiseresearchgroup.github.io/">
                                CRUISE Lab at UNSW
                            </a>
                        </li>
                        <div class="toggle-container">
                            <a id="light-toggle">
                                <i class="fas fa-moon"></i>
                                <i class="fas fa-sun"></i>
                            </a>
                        </div>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <!-- Content -->
    <div class="container mt-5">
        <div class="post">
            <header class="post-header">
                <h1 class="post-title">Publications 📚</h1>
                <!-- <p class="post-description">My research publications sorted by categories and year</p> -->
            </header>

            <article>
                <div class="publications">
                    <!-- Conference Papers -->
                    <div class="publication-section" id="conference-papers">
                        <h2 onclick="toggleSection('conference-papers')">Conference Papers</h2>
                        <div class="publications-list" id="conference-list"></div>
                    </div>

                    <!-- Journal Papers -->
                    <div class="publication-section" id="journal-papers">
                        <h2 onclick="toggleSection('journal-papers')">Journal Papers</h2>
                        <div class="publications-list" id="journal-list"></div>
                    </div>

                    <!-- Preprints -->
                    <div class="publication-section" id="preprints">
                        <h2 onclick="toggleSection('preprints')">Preprints</h2>
                        <div class="publications-list" id="preprint-list"></div>
                    </div>

                    <!-- Patents -->
                    <div class="publication-section" id="patents">
                        <h2 onclick="toggleSection('patents')">Patents</h2>
                        <div class="publications-list" id="patent-list"></div>
                    </div>
                </div>
            </article>

        </div>
    </div>
    <!-- Footer -->
    <footer class="sticky-bottom mt-5">
        <div class="container">
            &copy; Copyright 2025 Hao Xue.
            Last updated: Feb. 3, 2025.
        </div>
    </footer>

    <!-- Custom JS for handling publications -->
    <script>
        // Load BibTeX file content
        async function fetchBibTeX() {
            try {
                const response = await fetch('assets/publications.bib');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return await response.text();
            } catch (e) {
                console.error('Error fetching BibTeX file:', e);
                return null;
            }
        }

        // Load and parse BibTeX file
        async function loadPublications() {
            try {
                // 确保 bibtexParse 已加载
                if (typeof bibtexParse === 'undefined') {
                    console.error('BibTeX parser not loaded');
                    return null;
                }

                const bibtex = await fetchBibTeX();
                if (!bibtex) return null;

                console.log('Loaded BibTeX:', bibtex);
                
                // 解析 BibTeX
                let parsed;
                try {
                    parsed = bibtexParse.toJSON(bibtex);
                } catch (parseError) {
                    console.error('Error parsing BibTeX:', parseError);
                    return null;
                }
                
                console.log('Parsed publications:', parsed);
                
                const publications = {
                    conference: [],
                    journal: [],
                    preprint: [],
                    patent: []
                };

                // Categorize publications
                parsed.forEach(pub => {
                    if (!pub || !pub.entryType || !pub.entryTags) {
                        console.warn('Invalid publication entry:', pub);
                        return;
                    }

                    console.log('Processing publication:', pub);
                    console.log('Entry type:', pub.entryType);
                    console.log('Entry tags:', pub.entryTags);

                    if (pub.entryType === 'inproceedings') {
                        publications.conference.push(pub);
                    } else if (pub.entryType === 'article') {
                        // 检查是否为预印本
                        const isPreprint = pub.entryTags.journal && 
                            (pub.entryTags.journal.toLowerCase().includes('arxiv') || 
                             pub.entryTags.journal.toLowerCase().includes('preprint')) ||
                            (pub.entryTags.archivePrefix && 
                             pub.entryTags.archivePrefix.toLowerCase() === 'arxiv') ||
                            (pub.entryTags.note && 
                             pub.entryTags.note.toLowerCase().includes('preprint'));

                        console.log('Is article preprint?', isPreprint);

                        if (isPreprint) {
                            publications.preprint.push(pub);
                        } else {
                            publications.journal.push(pub);
                        }
                    } else if (pub.entryType === 'misc' || pub.entryType.toLowerCase() === 'arxiv') {
                        // misc 类型或 arXiv 类型的条目都可能是预印本
                        const isPreprint = (pub.entryTags.archivePrefix && 
                                         pub.entryTags.archivePrefix.toLowerCase() === 'arxiv') ||
                                        (pub.entryTags.note && 
                                         pub.entryTags.note.toLowerCase().includes('preprint')) ||
                                        (pub.entryTags.journal && 
                                         pub.entryTags.journal.toLowerCase().includes('arxiv')) ||
                                        pub.entryType.toLowerCase() === 'arxiv';
                        
                        console.log('Is misc/arxiv preprint?', isPreprint);

                        if (isPreprint) {
                            publications.preprint.push(pub);
                        }
                    } else if (pub.entryType === 'patent') {
                        publications.patent.push(pub);
                    }

                    // 如果有 arXiv 编号但没被归类为预印本，也将其归类为预印本
                    if (pub.entryTags.eprint && !publications.preprint.includes(pub)) {
                        console.log('Found eprint:', pub.entryTags.eprint);
                        publications.preprint.push(pub);
                    }
                });

                console.log('Final categorized publications:', publications);
                console.log('Preprints count:', publications.preprint.length);

                // Sort each category by year
                Object.keys(publications).forEach(type => {
                    publications[type].sort((a, b) => (b.entryTags.year || 0) - (a.entryTags.year || 0));
                });

                return publications;
            } catch (e) {
                console.error('Error loading publications:', e);
                return null;
            }
        }

        // Render publications by type
        function renderPublications(publications) {
            const types = ['conference', 'journal', 'preprint', 'patent'];
            
            types.forEach(type => {
                const container = document.getElementById(`${type}-list`);
                if (!container) return;
                
                container.innerHTML = '';
                
                if (!publications[type] || publications[type].length === 0) {
                    console.log(`No publications for type: ${type}`); // 添加调试日志
                    return;
                }

                const years = [...new Set(publications[type].map(p => p.entryTags.year))].sort((a, b) => b - a);
                
                years.forEach(year => {
                    const yearPubs = publications[type].filter(p => p.entryTags.year === year);
                    if (yearPubs.length > 0) {
                        const yearDiv = document.createElement('div');
                        yearDiv.className = 'publication-year';
                        yearDiv.textContent = year;
                        yearDiv.onclick = () => toggleYear(yearDiv);
                        container.appendChild(yearDiv);
                        
                        const yearGroup = document.createElement('div');
                        yearGroup.className = 'year-group';
                        
                        yearPubs.forEach(pub => {
                            const pubDiv = document.createElement('div');
                            pubDiv.className = 'publication-item';
                            
                            // 处理作者名字，将 "Hao Xue" 加粗
                            const authors = pub.entryTags.author.split(' and ')
                                .map(author => author.trim())
                                .map(author => {
                                    if (author.includes('Xue, Hao')) {
                                        return `<strong>${author}</strong>`;
                                    }
                                    return author;
                                })
                                .join(', ');

                            pubDiv.innerHTML = `
                                <div class="publication-title">${pub.entryTags.title}</div>
                                <div class="publication-authors">${authors}</div>
                                <div class="publication-venue">${pub.entryTags.booktitle || pub.entryTags.journal || ''}</div>
                                <div class="publication-links">
                                    ${pub.entryTags.url ? `<a href="${pub.entryTags.url}" target="_blank">Paper</a>` : ''}
                                    ${pub.entryTags.code ? `<a href="${pub.entryTags.code}" target="_blank">Code</a>` : ''}
                                    ${pub.entryTags.video ? `<a href="${pub.entryTags.video}" target="_blank">Video</a>` : ''}
                                </div>
                            `;
                            yearGroup.appendChild(pubDiv);
                        });
                        
                        container.appendChild(yearGroup);
                    }
                });
            });
        }

        // 等待页面和所有脚本加载完成
        window.addEventListener('load', async () => {
            try {
                const publications = await loadPublications();
                if (publications) {
                    renderPublications(publications);
                    // 初始化折叠状态
                    initializeCollapsibleState();
                } else {
                    console.error('Failed to load publications');
                    // 显示错误信息给用户
                    document.querySelectorAll('.publications-list').forEach(container => {
                        container.innerHTML = '<div class="alert alert-warning">Unable to load publications. Please try again later.</div>';
                    });
                }
            } catch (e) {
                console.error('Error in main execution:', e);
            }
        });

        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId);
            const heading = section.querySelector('h2');
            const list = section.querySelector('.publications-list');
            
            heading.classList.toggle('collapsed');
            list.classList.toggle('collapsed');
            
            // Store the state
            const isCollapsed = heading.classList.contains('collapsed');
            localStorage.setItem(`section_${sectionId}`, isCollapsed);
        }

        function toggleYear(yearDiv) {
            yearDiv.classList.toggle('collapsed');
            const yearGroup = yearDiv.nextElementSibling;
            yearGroup.classList.toggle('collapsed');
            
            // Store the state
            const isCollapsed = yearDiv.classList.contains('collapsed');
            const sectionId = yearDiv.closest('.publication-section').id;
            const year = yearDiv.textContent.trim();
            localStorage.setItem(`year_${sectionId}_${year}`, isCollapsed);
        }

        function initializeCollapsibleState() {
            // Set all sections to collapsed by default
            document.querySelectorAll('.publication-section').forEach(section => {
                const heading = section.querySelector('h2');
                const list = section.querySelector('.publications-list');
                
                // Get stored state or default to collapsed
                const sectionId = section.id;
                const storedState = localStorage.getItem(`section_${sectionId}`);
                const isCollapsed = storedState === null ? true : storedState === 'true';
                
                if (isCollapsed) {
                    heading.classList.add('collapsed');
                    list.classList.add('collapsed');
                }
                
                // Store the initial state
                localStorage.setItem(`section_${sectionId}`, isCollapsed);
            });

            // Set all years to collapsed by default
            document.querySelectorAll('.publication-year').forEach(yearDiv => {
                const yearGroup = yearDiv.nextElementSibling;
                const sectionId = yearDiv.closest('.publication-section').id;
                const year = yearDiv.textContent.trim();
                
                // Get stored state or default to collapsed
                const storedState = localStorage.getItem(`year_${sectionId}_${year}`);
                const isCollapsed = storedState === null ? true : storedState === 'true';
                
                if (isCollapsed) {
                    yearDiv.classList.add('collapsed');
                    yearGroup.classList.add('collapsed');
                }
                
                // Store the initial state
                localStorage.setItem(`year_${sectionId}_${year}`, isCollapsed);
            });
        }
    </script>
</body>
<!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js"
    integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A=="
    crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
    integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ=="
    crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js"
    integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw=="
    crossorigin="anonymous"></script>
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/mansory.js" type="text/javascript"></script>
<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"
    integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/assets/zoom.js"></script>
<!-- Load Common JS -->
<script src="/assets/common.js"></script>
</html>